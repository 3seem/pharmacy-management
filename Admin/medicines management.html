<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medicine Management</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="../assets/CSS/medicines.css">
</head>

<body style="margin: 8px;">

    <!-- Sidebar -->
    <aside id="sidebar" class="sidebar">
        <div class="sidebar-header">
            <span class="sidebar-title">Menu</span>
            <button id="closeSidebar" class="icon-btn">&times;</button>
        </div>

        <nav class="menu">
            <ul>
                <li><a href="dashboard.html"><span class="icon">üìä</span> Dashboard</a></li>
                <li><a href="Sales&Transactions.html"><span class="icon">üõí</span> Sales & Transaction</a></li>
                <li><a href="medicines management.html"><span class="icon">üíä</span> Medicine Management</a></li>
                <li><a href="Suppliers.html"><span class="icon">üöö</span> Suppliers Management</a></li>
                <li><a href="order.html"><span class="icon">üì¶</span> Order Management System</a></li>
                <li><a href="usermanagement.html"><span class="icon">‚öôÔ∏è</span> User Managenent</a></li>
            </ul>
        </nav>
    </aside>

    <!-- Header -->
    <header class="header card-flat">
        <div class="container header-inner">
            <div class="header-left">
                <button id="openSidebar" class="icon-btn menu-toggle">‚ò∞</button>
                <div class="logo">PharmaCare</div>
            </div>

            <div class="header-right hide-sm">
                <div class="text-right">
                    <p class="muted small">Cashier</p>
                    <p class="strong">Mohamed Ahmed</p>
                </div>
                <div class="avatar gradient-circle-sm">MA</div>
            </div>
        </div>
    </header>
    <!-- Page Content -->
    <main class="container main">
        <div class="container mx-auto p-6 max-w-7xl">
            <div class="head-title">
                <h1 style="font-size:xx-large; font-weight: 700;">Medicine Management</h1>
            </div>
            <!-- Filters and Search -->
            <div class="card mb-6 p-4 bg-white rounded-lg shadow-md">
                <div class="grid gap-4 md:grid-cols-2 lg:grid-cols-5">
                    <!-- Search -->
                    <div class="relative lg:col-span-2">
                        <input id="searchInput" type="text" placeholder="Search by name or batch number..."
                            class="pl-10 pr-3 py-2 w-full border border-gray-300 rounded-md" />
                        <svg class="w-5 h-5 text-gray-400 absolute left-3 top-3" fill="none" stroke="currentColor"
                            viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                        </svg>
                    </div>
                    <!-- Category Filter -->
                    <select id="filterCategory" class="border border-gray-300 rounded-md p-2">
                        <option value="all">All Categories</option>
                        <!-- Populated by JS -->
                    </select>
                    <!-- Supplier Filter -->
                    <select id="filterSupplier" class="border border-gray-300 rounded-md p-2">
                        <option value="all">All Suppliers</option>
                        <!-- Populated by JS -->
                    </select>
                    <!-- Stock Level Filter -->
                    <select id="filterStock" class="border border-gray-300 rounded-md p-2">
                        <option value="all">All Stock Levels</option>
                        <option value="low">Low Stock</option>
                        <option value="out">Out of Stock</option>
                    </select>
                    <!-- Expiration Filter -->
                    <select id="filterExpiration" class="border border-gray-300 rounded-md p-2">
                        <option value="all">All Expiration</option>
                        <option value="soon">Expiring Soon (90 days)</option>
                        <option value="expired">Expired</option>
                    </select>
                </div>
            </div>

            <!-- Action Bar -->
            <div class="flex items-center justify-between mb-4">
                <div id="countText" class="text-sm text-gray-600">
                    Showing 0 of 0 medicines
                </div>
                <button id="btnAdd" class="flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md">
                    <span class="material-icons">add</span> Add New Medicine
                </button>
            </div>

            <!-- Medicine Table -->
            <div class="overflow-x-auto bg-white rounded-lg shadow">
                <table class="min-w-full border-collapse">
                    <thead style="background-color: #DBECFE;">
                        <tr>
                            <th class="px-4 py-2 text-left">Medicine Name</th>
                            <th class="px-4 py-2 text-left">Category</th>
                            <th class="px-4 py-2 text-left">Batch #</th>
                            <th class="px-4 py-2 text-left">Supplier</th>
                            <th class="px-4 py-2 text-left">Unit Price</th>
                            <th class="px-4 py-2 text-left">Stock Qty</th>
                            <th class="px-4 py-2 text-left">Status</th>
                            <th class="px-4 py-2 text-left">Expiration Date</th>
                            <th class="px-4 py-2 text-right">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                        <!-- Rows injected by JS -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Add Medicine Modal -->
        <div id="addModal" class="modal">
            <div class="modal-content">
                <h2 class="text-xl font-bold mb-2">Add New Medicine</h2>
                <p class="mb-4 text-gray-600">Enter the details of the new medicine to add to inventory.</p>
                <form id="addForm" class="space-y-4">
                    <div>
                        <label class="block font-medium mb-1">Medicine Name *</label>
                        <input id="add-name" type="text" class="border border-gray-300 rounded-md p-2 w-full"
                            required />
                    </div>
                    <div class="grid gap-4 grid-cols-2">
                        <div>
                            <label class="block font-medium mb-1">Category *</label>
                            <select id="add-category" class="border border-gray-300 rounded-md p-2 w-full" required>
                                <option value="">Select category</option>
                                <!-- Filled by JS -->
                            </select>
                        </div>
                        <div>
                            <label class="block font-medium mb-1">Supplier *</label>
                            <select id="add-supplier" class="border border-gray-300 rounded-md p-2 w-full" required>
                                <option value="">Select supplier</option>
                                <!-- Filled by JS -->
                            </select>
                        </div>
                    </div>
                    <div class="grid gap-4 grid-cols-2">
                        <div>
                            <label class="block font-medium mb-1">Unit Price ($) *</label>
                            <input id="add-unitPrice" type="number" min="0" step="0.01"
                                class="border border-gray-300 rounded-md p-2 w-full" required />
                        </div>
                        <div>
                            <label class="block font-medium mb-1">Batch Number *</label>
                            <input id="add-batchNumber" type="text" class="border border-gray-300 rounded-md p-2 w-full"
                                required />
                        </div>
                    </div>
                    <div class="grid gap-4 grid-cols-3">
                        <div>
                            <label class="block font-medium mb-1">Stock Quantity *</label>
                            <input id="add-stockQuantity" type="number" min="0"
                                class="border border-gray-300 rounded-md p-2 w-full" required />
                        </div>
                        <div>
                            <label class="block font-medium mb-1">Min Stock Level *</label>
                            <input id="add-minStockLevel" type="number" min="0"
                                class="border border-gray-300 rounded-md p-2 w-full" required />
                        </div>
                        <div>
                            <label class="block font-medium mb-1">Expiration Date *</label>
                            <input id="add-expirationDate" type="date"
                                class="border border-gray-300 rounded-md p-2 w-full" required />
                        </div>
                    </div>
                    <div class="flex justify-end gap-2 pt-4">
                        <button type="button" onclick="closeModal('addModal')"
                            class="px-4 py-2 bg-gray-200 rounded-md">Cancel</button>
                        <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded-md">Add Medicine</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Edit Medicine Modal -->
        <div id="editModal" class="modal">
            <div class="modal-content">
                <h2 class="text-xl font-bold mb-2">Edit Medicine</h2>
                <p class="mb-4 text-gray-600">Update the medicine information below.</p>
                <form id="editForm" class="space-y-4">
                    <div>
                        <label class="block font-medium mb-1">Medicine Name</label>
                        <input id="edit-name" type="text" class="border border-gray-300 rounded-md p-2 w-full"
                            required />
                    </div>
                    <div class="grid gap-4 grid-cols-2">
                        <div>
                            <label class="block font-medium mb-1">Category</label>
                            <input id="edit-category" type="text" class="border border-gray-300 rounded-md p-2 w-full"
                                required />
                        </div>
                        <div>
                            <label class="block font-medium mb-1">Supplier</label>
                            <input id="edit-supplier" type="text" class="border border-gray-300 rounded-md p-2 w-full"
                                required />
                        </div>
                    </div>
                    <div class="grid gap-4 grid-cols-2">
                        <div>
                            <label class="block font-medium mb-1">Unit Price ($)</label>
                            <input id="edit-unitPrice" type="number" min="0" step="0.01"
                                class="border border-gray-300 rounded-md p-2 w-full" required />
                        </div>
                        <div>
                            <label class="block font-medium mb-1">Batch Number</label>
                            <input id="edit-batchNumber" type="text"
                                class="border border-gray-300 rounded-md p-2 w-full" required />
                        </div>
                    </div>
                    <div class="grid gap-4 grid-cols-3">
                        <div>
                            <label class="block font-medium mb-1">Stock Quantity</label>
                            <input id="edit-stockQuantity" type="number" min="0"
                                class="border border-gray-300 rounded-md p-2 w-full" required />
                        </div>
                        <div>
                            <label class="block font-medium mb-1">Min Stock Level</label>
                            <input id="edit-minStockLevel" type="number" min="0"
                                class="border border-gray-300 rounded-md p-2 w-full" required />
                        </div>
                        <div>
                            <label class="block font-medium mb-1">Expiration Date</label>
                            <input id="edit-expirationDate" type="date"
                                class="border border-gray-300 rounded-md p-2 w-full" required />
                        </div>
                    </div>
                    <div class="flex justify-end gap-2 pt-4">
                        <button type="button" onclick="closeModal('editModal')"
                            class="px-4 py-2 bg-gray-200 rounded-md">Cancel</button>
                        <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded-md">Update
                            Medicine</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Delete Confirmation Modal -->
        <div id="deleteModal" class="modal">
            <div class="modal-content">
                <h2 class="text-xl font-bold mb-2">Delete Medicine?</h2>
                <p class="mb-4">Are you sure you want to delete <strong id="deleteName"></strong>?<br>
                    This action cannot be undone.</p>
                <div class="flex justify-end gap-2 pt-4">
                    <button type="button" onclick="closeModal('deleteModal')"
                        class="px-4 py-2 bg-gray-200 rounded-md">Cancel</button>
                    <button id="confirmDeleteBtn" class="px-4 py-2 bg-red-600 text-white rounded-md">Delete</button>
                </div>
            </div>
        </div>

        <!-- Stock Adjustment Modal -->
        <div id="adjustModal" class="modal">
            <div class="modal-content">
                <h2 class="text-xl font-bold mb-2">Adjust Stock Level</h2>
                <p class="mb-4 text-gray-600"><span id="adjustName"></span></p>
                <form id="adjustForm" class="space-y-4">
                    <div class="bg-gray-50 p-3 rounded-lg">
                        <div class="text-sm text-gray-600">Current Stock</div>
                        <div id="currentStock" class="text-2xl">0 units</div>
                    </div>
                    <div>
                        <label class="block font-medium mb-1">Adjustment Type</label>
                        <div class="grid grid-cols-2 gap-2">
                            <button type="button" id="btnAddStock" class="px-4 py-2 border rounded-md">Add
                                Stock</button>
                            <button type="button" id="btnRemoveStock" class="px-4 py-2 border rounded-md">Remove
                                Stock</button>
                        </div>
                    </div>
                    <div>
                        <label class="block font-medium mb-1">Quantity</label>
                        <input id="adjustQuantity" type="number" min="1"
                            class="border border-gray-300 rounded-md p-2 w-full" required />
                    </div>
                    <div>
                        <label class="block font-medium mb-1">Reason</label>
                        <select id="reasonType" class="border border-gray-300 rounded-md p-2 w-full" required>
                            <option value="">Select reason</option>
                            <!-- Populated by JS -->
                        </select>
                    </div>
                    <div id="otherReasonDiv" style="display:none;">
                        <label class="block font-medium mb-1">Additional Notes</label>
                        <textarea id="otherReason" rows="3"
                            class="border border-gray-300 rounded-md p-2 w-full"></textarea>
                    </div>
                    <div id="newStockPreview" class="bg-blue-50 p-3 rounded-lg border border-blue-200"
                        style="display:none;">
                        <div class="text-sm text-blue-600">New Stock Level</div>
                        <div id="newStockLevel" class="text-2xl text-blue-900">0 units</div>
                        <div id="belowZeroNote" class="text-xs text-red-600 mt-1" style="display:none;">
                            Cannot go below 0. Will be set to 0.
                        </div>
                    </div>
                    <div class="flex justify-end gap-2 pt-4">
                        <button type="button" onclick="closeModal('adjustModal')"
                            class="px-4 py-2 bg-gray-200 rounded-md">Cancel</button>
                        <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded-md">Apply
                            Adjustment</button>
                    </div>
                </form>
            </div>
        </div>
    </main>

    <script src="../assets/JS/medicines.js"></script>
</body>

</html>